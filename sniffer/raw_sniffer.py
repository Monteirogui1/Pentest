import socket
import struct

s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)  # Linux and Mac IPPROTO_TCP

s.bind(('', 0))

pacotes = s.recvfrom(10000)
desco = struct.unpack('!BBHHHBBH4s4s', pacotes[0][0:20])

print('From:', pacotes[1][0])
print('Pacotes: ', desco)
print('Ip Version:', desco[0] >> 4)
print('TTL:', desco[5])
print('Protocol:', desco[6])
print('Source:', socket.inet_ntoa(desco[8]))
print('Target:', socket.inet_ntoa(desco[9]))